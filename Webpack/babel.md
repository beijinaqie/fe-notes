# babelæ ¸å¿ƒ

Babelå·¥ä½œåŸç†æœ¬è´¨ä¸Šå°±æ˜¯ä¸‰ä¸ªæ­¥éª¤ï¼šè§£æã€è½¬æ¢ã€è¾“å‡ºï¼Œå¦‚ä¸‹ğŸ‘‡æ‰€ç¤ºï¼Œ

![](https://segmentfault.com/img/remote/1460000040174870)

- è§£æé˜¶æ®µä¸»è¦è¿›è¡Œè¯æ³•å’Œè¯­æ³•è§£æï¼Œç”ŸæˆASTè¯­æ³•æ ‘ï¼Œä¸»è¦ç”±`@babel/parser`å®Œæˆï¼›è§£æå¼•æ“ä¸º`babyIon`
- è½¬æ¢é˜¶æ®µå°†ASTè¯­æ³•æ ‘è½¬æ¢ä¸º**ç›®æ ‡çš„ASTè¯­æ³•æ ‘**ï¼Œä¸»è¦ç”±`@babel/traverse`å®Œæˆï¼›
- ç”Ÿæˆé˜¶æ®µå°†**ç›®æ ‡è¯­æ³•æ ‘**ç”Ÿæˆæœ€ç»ˆä»£ç ï¼Œä¸»è¦ç”±`@babel/generator`å®Œæˆï¼›

1. @babel/parser å°†æºä»£ç è§£ææˆ ASTã€‚
2. @babel/generator å°†ASTè§£ç ç”Ÿ jsä»£ç ã€‚
3. @babel/core åŒ…æ‹¬äº†æ•´ä¸ªbabelå·¥ä½œæµï¼Œä¹Ÿå°±æ˜¯è¯´åœ¨@babel/coreé‡Œé¢æˆ‘ä»¬ä¼šä½¿ç”¨åˆ°@babel/parserã€transformer[s]ã€ä»¥åŠ@babel/generatorã€‚
4. @babel/code-frame ç”¨äºç”Ÿæˆé”™è¯¯ä¿¡æ¯å¹¶ä¸”æ‰“å°å‡ºé”™è¯¯åŸå› å’Œé”™è¯¯è¡Œæ•°ã€‚ï¼ˆå…¶å®å°±æ˜¯ä¸ªconsoleå·¥å…·ç±»ï¼‰
5. @babel/helpers ä¹Ÿæ˜¯å·¥å…·ç±»ï¼Œæä¾›äº†ä¸€äº›å†…ç½®çš„å‡½æ•°å®ç°ï¼Œä¸»è¦ç”¨äºbabelæ’ä»¶çš„å¼€å‘ã€‚
6. @babel/runtime ä¹Ÿæ˜¯å·¥å…·ç±»ï¼Œä½†æ˜¯æ˜¯ä¸ºäº†babelç¼–è¯‘æ—¶æä¾›ä¸€äº›åŸºç¡€å·¥å…·åº“ã€‚ä½œç”¨äºtransformer[s]é˜¶æ®µï¼Œå½“ç„¶è¿™æ˜¯ä¸€ä¸ªå·¥å…·åº“ï¼Œå¦‚æœè¦ä½¿ç”¨è¿™ä¸ªå·¥å…·åº“ï¼Œè¿˜éœ€è¦å¼•å…¥@babel/plugin-transform-runtimeï¼Œå®ƒæ‰æ˜¯transformer[s]é˜¶æ®µé‡Œé¢çš„ä¸»è§’ã€‚
7. @babel/template ä¹Ÿæ˜¯å·¥å…·ç±»ï¼Œä¸»è¦ç”¨é€”æ˜¯ä¸ºparseræä¾›æ¨¡æ¿å¼•æ“ï¼Œæ›´åŠ å¿«é€Ÿçš„è½¬åŒ–æˆAST
8. @babel/traverse ä¹Ÿæ˜¯å·¥å…·ç±»ï¼Œä¸»è¦ç”¨é€”æ˜¯æ¥ä¾¿åˆ©ASTæ ‘ï¼Œä¹Ÿå°±æ˜¯åœ¨@babel/generatorè¿‡ç¨‹ä¸­ç”Ÿæ•ˆã€‚
9. @babel/types ä¹Ÿæ˜¯å·¥å…·ç±»ï¼Œä¸»è¦ç”¨é€”æ˜¯åœ¨åˆ›å»ºASTçš„è¿‡ç¨‹ä¸­åˆ¤æ–­å„ç§è¯­æ³•çš„ç±»å‹ã€‚

## babel-loader

babel-loader æ˜¯webpackå’Œbabelä¹‹å‰çš„æ¡¥æ¢ï¼Œé…ç½®å¯¹åº”çš„pluginså»ç»“åˆbabelå°†ES6+è¯­æ³•è½¬è¯‘æˆES5è¯­æ³•ã€‚webpacké€šè¿‡babel-loaderæ‹¥æœ‰äº†è°ƒç”¨babelçš„èƒ½åŠ›ï¼Œä½¿ç”¨@babel-coreæ¥è§£æjsä»£ç ä¸ºASTï¼Œæ¥ç€å°±ä¼šå¯¹ä»£ç è¿›è¡Œè½¬æ¢ï¼Œè¿™ä¸ªæ—¶å€™é€šè¿‡pluginå¯¹è¾“å‡ºçš„ASTè¿›è¡Œå¹²æ¶‰ï¼Œè½¬æ¢æ–°çš„ASTï¼Œæœ€åå°†ASTç”Ÿæˆæ–°çš„es5ä»£ç ã€‚

## @babel/cli

Babel è‡ªå¸¦äº†ä¸€ä¸ªå†…ç½®çš„ CLI å‘½ä»¤è¡Œå·¥å…·ï¼Œå¯é€šè¿‡å‘½ä»¤è¡Œç¼–è¯‘æ–‡ä»¶ã€‚å…¶åº•å±‚ä¾ç„¶ä½¿ç”¨@babel/coreï¼Œå¦‚æœéœ€è¦ä½¿ç”¨è¯·è¿@babel/coreä¸€å¹¶å®‰è£…ã€‚

## @babel/core

babelçš„æ ¸å¿ƒå·¥å…·åŒ…ã€‚ä»–ä¼šåœ¨babelçš„æ•´ä¸ªå·¥ä½œæµç¨‹ä¸­è°ƒç”¨å¯¹åº”çš„æ’ä»¶æ¥å·¥ä½œã€‚@babel/coreæœ¬èº«ä¸å…·å¤‡è½¬æ¢å¤„ç†çš„åŠŸèƒ½ï¼Œå®ƒæŠŠè½¬æ¢çš„åŠŸèƒ½æ‹†åˆ†åˆ°ä¸€ä¸ªä¸ªæ’ä»¶ï¼ˆpluginsï¼‰ä¸­ï¼›å› æ­¤å½“æˆ‘ä»¬ä¸æ·»åŠ ä»»ä½•æ’ä»¶çš„æ—¶å€™ï¼Œè¾“å…¥è¾“å‡ºä»£ç æ˜¯ç›¸åŒçš„ã€‚

```js
var babelCore = require("@babel/core");
var sourceCode = `let fn = (num) => num + 2`;

var options = {
  //æ˜¯å¦ç”Ÿæˆè§£æçš„ä»£ç 
  code: true,
  //æ˜¯å¦ç”ŸæˆæŠ½è±¡è¯­æ³•æ ‘
  ast: true,
  //æ˜¯å¦ç”ŸæˆsourceMap
  sourceMaps: true,
  plugins: [],
  presets: [],
};

babelCore.transform(sourceCode, options, function (err, result) {
  console.log(sourceCode); // æºä»£ç 
  console.log(result.code); // è½¬æ¢åä»£ç 
  console.log(result.map); // source map
  console.log(result.ast); // astè¯­æ³•æ ‘
});


```

![](https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/3812f7af494e4d45ac477992b9bc1ed6~tplv-k3u1fbpfcp-watermark.awebp)

## @babel/preset-env

babelçš„é¢„è®¾ï¼Œå°†es6ï¼Œes7ç­‰é«˜esç‰ˆæœ¬è½¬æˆes5ç‰ˆæœ¬ï¼Œå…¶å†…éƒ¨å°±æ˜¯è‹¥å¹²ä¸ªé«˜ç‰ˆæœ¬è¯­æ³•è½¬ä½ç‰ˆæœ¬è¯­æ³•çš„pluginé›†åˆ

## babelæ’ä»¶

babelæ’ä»¶å³æ˜¯å°†é«˜ç‰ˆæœ¬è¯­æ³•è½¬åŒ–ä¸ºä½ç‰ˆæœ¬è¯­æ³•ï¼Œæ¯ä¸ªç‰ˆæœ¬å¯¹åº”ä¸€ä¸ªæ’ä»¶ã€‚

